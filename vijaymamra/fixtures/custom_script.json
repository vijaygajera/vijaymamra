[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Invoice", 
  "modified": "2018-03-15 17:01:07.176615", 
  "name": "Sales Invoice-Client", 
  "script": "cur_frm.add_fetch('item_code', 'weight_per_bag', 'weight_per_bag')\nfrappe.ui.form.on(\"Sales Invoice Item\", \"bag\", function(frm, cdt, cdn) {\n\tvar child = locals[cdt][cdn];\n\tresult_value = child.bag * child.weight_per_bag;\n\tfrappe.model.set_value(cdt, cdn, \"qty\", result_value)\n});\nfrappe.ui.form.on(\"Sales Invoice Item\", \"weight_per_bag\", function(frm, cdt, cdn) {\n\tvar child = locals[cdt][cdn];\n\tresult_value = child.bag * child.weight_per_bag;\n\tfrappe.model.set_value(cdt, cdn, \"qty\", result_value)\n});\nfrappe.ui.form.on(\"Sales Invoice Item\", \"bag\", function(frm, cdt, cdn) {\n\t// code for calculate total and set on parent field.\n\tgrand_total = 0;\n\t$.each(frm.doc.items || [], function(i, d) {\n\t\tgrand_total += flt(d.bag);\n\t});\n\tfrm.set_value(\"total_bag\", grand_total);\n});\n//fetch item detail\nfrappe.ui.form.on(\"Sales Invoice\", \"refresh\", function(frm) {\n\titem_detail_new = \" \"\n\t$.each(frm.doc.items || [], function(i, d) {\n\t\titem_detail_new += cstr(d.item_code) + \"/\" + cstr(d.bag) + \" Bag  ;\" });\nconsole.log(item_detail_new);\n});\n//send sms\nfrappe.ui.form.on(\"Sales Invoice\", \"refresh\", function(frm) {\n    frm.add_custom_button(__(\"Send SMS\"), function() {\nvar message = 'Dear Sir,' + frm.doc.customer + 'Your order has been dispatched     ' +  item_detail_new + 'Truck No.: ' + frm.doc.truck_no + 'Drive Moble No. ' + frm.doc.driver_mobile + 'From: Vijay Mamra Pvt.Ltd.';\n  frappe.call({\n    method: \"frappe.core.doctype.sms_settings.sms_settings.send_sms\",\n    args: {\n      receiver_list: [frm.doc.contact_mobile +\" , 9825219456 , \" + frm.doc.mobile_no],\n      msg: message,\n    },\n    callback: function(r) {\n      if(r.exc) {msgprint(r.exc); return;}  }\n  \t});\n    });\n});\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Order", 
  "modified": "2018-03-15 16:30:25.932156", 
  "name": "Sales Order-Client", 
  "script": "cur_frm.add_fetch('item_code', 'weight_per_bag', 'weight_per_bag')\n\n\nfrappe.ui.form.on(\"Sales Order Item\", \"bag\", function(frm, cdt, cdn) {\n\tvar child = locals[cdt][cdn];\n\tresult_value = child.bag * child.weight_per_bag;\n\tfrappe.model.set_value(cdt, cdn, \"qty\", result_value)\n});\nfrappe.ui.form.on(\"Sales Order Item\", \"weight_per_bag\", function(frm, cdt, cdn) {\n\tvar child = locals[cdt][cdn];\n\tresult_value = child.bag * child.weight_per_bag;\n\tfrappe.model.set_value(cdt, cdn, \"qty\", result_value)\n});\n\n// bag total calculation\nfrappe.ui.form.on(\"Sales Order Item\", \"bag\", function(frm, cdt, cdn) {\n\t\tgrand_total = 0;\n\t$.each(frm.doc.items || [], function(i, d) {\n\t\tgrand_total += flt(d.bag);});\n\tfrm.set_value(\"total_bag\", grand_total);});\n\n//fetch item detail\nfrappe.ui.form.on(\"Sales Order\", \"refresh\", function(frm) {\n\titem_detail_new = \" \"\n\t$.each(frm.doc.items || [], function(i, d) {\n\t\titem_detail_new += cstr(d.item_code) + \"/\" + cstr(d.bag) + \" Bag / Rate \" + cstr(d.rate) + \" Per Kg\" });\nconsole.log(item_detail_new);\n});\n//send sms\nfrappe.ui.form.on(\"Sales Order\", \"refresh\", function(frm) {\n    frm.add_custom_button(__(\"Send SMS\"), function() {\nvar message = 'Dear Sir,' + frm.doc.customer + 'We booked Order No: ' + frm.doc.name + item_detail_new + (frm.doc.sales_partner ? ('booked by: ' + frm.doc.sales_partner + '') : '') + 'From: Vijay Mamra Pvt.Ltd.';\n  frappe.call({\n    method: \"frappe.core.doctype.sms_settings.sms_settings.send_sms\",\n    args: {\n      receiver_list: [frm.doc.contact_mobile +\" , 9825219456 , \" + frm.doc.mobile_no],\n      msg: message,\n    },\n    callback: function(r) {\n      if(r.exc) {msgprint(r.exc); return;}  }\n  \t});\n    });\n});\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Delivery Note", 
  "modified": "2018-03-15 17:23:31.282763", 
  "name": "Delivery Note-Client", 
  "script": "cur_frm.add_fetch('item_code', 'weight_per_bag', 'weight_per_bag')\n\n\nfrappe.ui.form.on(\"Delivery Note Item\", \"bag\", function(frm, cdt, cdn) {\n\tvar child = locals[cdt][cdn];\n\tresult_value = child.bag * child.weight_per_bag;\n\tfrappe.model.set_value(cdt, cdn, \"qty\", result_value)\n});\nfrappe.ui.form.on(\"Delivery Note Item\", \"weight_per_bag\", function(frm, cdt, cdn) {\n\tvar child = locals[cdt][cdn];\n\tresult_value = child.bag * child.weight_per_bag;\n\tfrappe.model.set_value(cdt, cdn, \"qty\", result_value)\n});\n\n// bag total calculation\nfrappe.ui.form.on(\"Delivery Note Item\", \"bag\", function(frm, cdt, cdn) {\n\t\tgrand_total = 0;\n\t$.each(frm.doc.items || [], function(i, d) {\n\t\tgrand_total += flt(d.bag);});\n\tfrm.set_value(\"total_bag\", grand_total);});\n\n//fetch item detail\nfrappe.ui.form.on(\"Delivery Note\", \"refresh\", function(frm) {\n\titem_detail_new = \" \"\n\t$.each(frm.doc.items || [], function(i, d) {\n\t\titem_detail_new += cstr(d.item_code) + \"/\" + cstr(d.bag) + \" Bag / Rate \" + cstr(d.rate) + \" Per Kg\" });\nconsole.log(item_detail_new);\n});\n//send sms\nfrappe.ui.form.on(\"Delivery Note\", \"refresh\", function(frm) {\n    frm.add_custom_button(__(\"Send SMS\"), function() {\nvar message = 'Dear Sir,' + frm.doc.customer + 'We booked Order No: ' + frm.doc.name + item_detail_new + (frm.doc.sales_partner ? ('booked by: ' + frm.doc.sales_partner + '') : '') + 'From: Vijay Mamra Pvt.Ltd.';\n  frappe.call({\n    method: \"frappe.core.doctype.sms_settings.sms_settings.send_sms\",\n    args: {\n      receiver_list: [frm.doc.contact_mobile +\" , 9825219456 , \" + frm.doc.mobile_no],\n      msg: message,\n    },\n    callback: function(r) {\n      if(r.exc) {msgprint(r.exc); return;}  }\n  \t});\n    });\n});\n", 
  "script_type": "Client"
 }
]